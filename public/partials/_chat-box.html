<!-- message.type =0 -> received msg / message.type =1 -> sent message -->
<div class="col m9 s12 no-padding grey lighten-3 chat-box scroll">
  <div ng-repeat="message in currentChat.messages">
    <div ng-switch="{{message.type}}">
      <div ng-switch-when="0">
        <div class="row" style="margin-top:10px;">
          <div class="col m12 s12">
            <div class="talk-bubble tri-right round left-top" style="float: left;">
              <div class="talktext">
                <p>{{message.content}}</p>
              </div>
            </div>
            <span class="grey-text lighten-5" style="font-size:80%;">{{message.time}}</span>
            <br />
          </div>
        </div>
      </div>
      <div ng-switch-when="1">
        <div class="row" style="margin-top:10px;">
          <div class="col m12 s12">
            <div style="float: right; max-width:90%;">
              <span class="grey-text lighten-5" style="font-size:80%;">{{message.time}}</span>
              <div class="talk-bubble tri-left round right-top" style="white-space: normal !important;">
                <div style="word-wrap: break-word" class="talktext-right">
                  <p style="word-wrap: break-word">{{message.content}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="footer col m9 offset-m3 s12 bottom-right-rounding">
  <form name="form" ng-submit="send(formMessage); formMessage=''" role="form" class="row">
    <div class="file-field input-field col m1 s1">
      <input type="file" ng-model="formFile">
      <span><i id="attach-file" class="material-icons">attach_file</i></span>
    </div>
    <div class="input-field col l9 m8 s9">
      <textarea id="message" ng-model="formMessage" ng-required="true" placeholder="Type your message" class="materialize-textarea scroll">
      </textarea>
    </div>
    <div class="input-field col l1 m2 s1 hide-on-small-only">
      <a ng-disabled="form.$invalid" ng-click="send(formMessage); formMessage=''" class="waves-effect waves-light btn" style="
    height: 5.7vh;">send</a>
    </div>
    <div class="input-field col s1 hide-on-med-and-up show-on-small">
      <a ng-disabled="form.$invalid" ng-click="send(formMessage); formMessage=''" class="btn-floating waves-effect waves-light"><i class="material-icons">send</i></a>
    </div>
  </form>
</div>

<script>
  $("#message").keypress(function(e) {
    if (e.which == 13 && !e.shiftKey) {
      $(this).closest("form").submit();
      e.preventDefault();
      return false;
    }
  });
  // $(".chat-box").scrollTop = $(".chat-box").scrollHeight;
</script>
